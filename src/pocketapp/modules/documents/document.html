<ion-view view-title="{{pageTitle}}" class="afasbackgroundcolor">
  <ion-nav-buttons side="right">
    <div ng-include="'modules/app/corebuttons.html'"></div>
    <button class="button icon ion-checkmark-circled button-clear afastopmenuicon" ng-if="doc && actions.length > 0" ng-click="showActions()" id="showActionsTop"></button>
  </ion-nav-buttons>
  <ion-tabs delegate-handle="tabsdocument" ng-if="doc && (!doc.hasNoReactions || landscape)" class="tabs-striped tabs-top" on-tap="scrollTop()" ng-class="isLandscape() ? '' : 'afas-tabs'">
    <ion-tab title="{{tabTitle0}}" on-select="selectDocTab(0)" id="tabDocument"></ion-tab>
    <ion-tab ng-if="!doc.hasNoReactions" title="{{tabTitle1}}" on-select="selectDocTab(1)" id="tabReactions"></ion-tab>
  </ion-tabs>

  <ion-content ng-class="{'has-tabs-top': (!doc.hasNoReactions || landscape)}">
    <ion-slides ng-if="doc" options="options" class="subjectSlider fadeDiv" slider="data.slider">
      <ion-slide-page>
        <ion-content delegate-handle="document">
          <div class="item item-text-wrap">
            <h1>{{doc.Description}}</h1>
          </div>
          <div class="item item-text-wrap">
            <p><span atrans="docpubdate">Publicatie datum </span> : {{doc.PublicationDate | date:"longDate" : + "0000"}}</p>
            <p ng-if="doc.Source"><span atrans="docsource">Bron</span> : {{doc.Source}}</p>
            <p ng-if="doc.SubTitle">{{doc.SubTitle}}</p>
            {{doc.Intro}}
          </div>
          <div ng-if="doc.AttachmentGuid" class="card">
            <div class="item item-divider" atrans="attachment">Bijlage</div>
            <a class="item item-icon-left item-icon-right" ng-click="downloadDocumentAttachment(doc)">
              <i class="icon ion-paperclip"></i>
              <span atrans="downloaddoc">Download</span> {{doc.AttachmentFilename}}
              <i class="icon ion-chevron-right icon-accessory"></i>
            </a>
            <a class="item item-icon-left item-icon-right" ng-if="doc.showInlineContent" ng-click="openDoc(true, { fileguid : doc.AttachmentGuid, filename : doc.AttachmentFilename})">
              <i class="icon ion-document"></i>
              <span atrans="showdoc">Toon</span> {{doc.AttachmentFilename}}
              <i class="icon ion-chevron-right icon-accessory"></i>
            </a>

          </div>

          <div ng-if="!doc.html" class="small-center-spinner">
            <ion-spinner></ion-spinner>
          </div>
          <div ng-if="doc.html" class="item item-text-wrap document" htmldoc="doc.html">
          </div>

          <div ng-if="doc.bodymailto" class="card">
            <a ng-href="mailto:?subject={{doc.descriptionmailto}}&body={{doc.bodymailto}}" class="item item-icon-left item-icon-right positive-bg light" id="sendemail">
              <i class="icon ion-ios-email"></i>
              <span atrans="forward">Doorsturen</span>
              <i class="icon ion-chevron-right icon-accessory afaswhite"></i>
            </a>
            <a ng-click="downloadQR(doc, 'qrurl', 'Description')" class="item item-icon-left item-icon-right positive-bg light" id="sendemail">
              <i class="icon ion-qr-scanner"></i>
              <span atrans="qrcode">QR Code</span>
              <i class="icon ion-chevron-right icon-accessory afaswhite"></i>
            </a>
          </div>

          <div ng-if="actions.length == 1" class="card fadeDiv">
            <a ng-click="showActions()" class="item item-icon-left positive-bg light" id="documentActions">
              <i class="icon ion-checkmark-circled"></i>
              <span>{{actions[0].Caption}}</span>
            </a>
          </div>

          <div ng-if="actions.length > 1" class="card fadeDiv">
            <a ng-click="showActions()" class="item item-icon-left item-icon-right positive-bg light" id="documentActions">
              <i class="icon ion-checkmark-circled"></i>
              <span atrans="docactions">Document acties</span>
              <i class="icon ion-chevron-right icon-accessory afaswhite"></i>
            </a>
          </div>

        </ion-content>
      </ion-slide-page>
      <ion-slide-page ng-if="!doc.hasNoReactions">
        <ion-content delegate-handle="reactions">
          <ion-refresher pulling-text="{{refreshText}}" on-refresh="refreshReactions()"></ion-refresher>
          <div ng-if="reactions.length > 0" class="fadeDiv extra-padding-bottom">
            <div ng-repeat="reaction in reactions" class="card border-radius-3px documentanimation" id="{{reaction.Id}}">
              <div class="item item-avatar item-text-wrap no-bottom-border" ng-click="gotoContact(reaction.PersonId, reaction.EmployeeId)">
                <img ng-if="reaction.PersonImageId" ng-src="{{reaction.PersonImageUrl}}" />
                <div class="reactionHeader">{{reaction.Person}}</div>
                <small class="nl2br comment" linkclick ng-bind-html="reaction.Text | mdparse | link2inappbrowser | insitesmilies"></small>
                <div class="afasreactiontime"><span>{{reaction.SubmitDate | date : "longDate" : "+0000"}}<br />{{reaction.SubmitDate | date : "shortTime" : "+0000"}}</span></div>
              </div>
              <div ng-if="reaction.AttachmentGuid && reaction.type=='file'" class="item item-divider item-icon-left item-icon-right reaction-attachment" ng-click="downloadAttachment(reaction)" id="reaction{{reaction.AttachmentGuid}}Attachment">
                <i class="icon ion-paperclip"></i>
                <span atrans="downloaddoc">Download</span> {{reaction.AttachmentFilename}}
                <i class="icon ion-chevron-right icon-accessory"></i>
              </div>
              <div ng-if="doc.showInlineContentReaction[reaction.guid] && reaction.AttachmentGuid" class="item item-divider item-icon-left item-icon-right reaction-attachment" ng-click="openDoc(true, { fileguid : reaction.AttachmentGuid, filename : reaction.AttachmentFilename})" id="reaction{{reaction.AttachmentGuid}}Attachment">
                <i class="icon ion-document"></i>
                <span atrans="showdoc">Toon</span> {{reaction.AttachmentFilename}}
                <i class="icon ion-chevron-right icon-accessory"></i>
              </div>
              <div ng-if="reaction.AttachmentGuid && reaction.type=='img'" class="item item-divider item-icon-left item-icon-right reaction-attachment" id="reaction{{reaction.AttachmentGuid}}Attachment">
                <i class="icon ion-arrow-down-a" ng-click="downloadAttachment(reaction)"></i>
                <img class="thumbnail" ng-src="{{reaction.imageUrl}}" ng-click="showImage(reaction.imageUrl)">
              </div>
              <div ng-if="reaction.PersonId == personid" class="row buttons-card-bottom no-margin-top">
                <button class="button button-clear button-assertive" ng-click="deleteReaction(reaction)"><i class="icon material-icons">delete</i><span atrans="deletecomment">Reactie verwijderen</span></button>

                <!--                <i class="icon ion-trash-b assertive"></i> <span atrans="deletecomment" class="assertive">Reactie verwijderen</span>-->
              </div>
            </div>
          </div>
          <div class="card text-center" ng-if="reactions == 0">
            <div class="item item-text-wrap"><img src="img/empty.png" /><br><span atrans="noreactionsdoc">Er zijn geen reacties op dit document</span></div>
          </div>
          <ion-infinite-scroll ng-if="showmore"
                               spinner=""
                               on-infinite="loadMore()"><ion-spinner class="item stable-bg dark text-center afasbuttonspinner"></ion-spinner></ion-infinite-scroll>
<!--          <button class="button icon ion-plus button-positive afas-fab" ng-click="goToNewReaction(doc.Id, doc.PageId)" id="newReaction"></button>-->

        </ion-content>
      </ion-slide-page>
    </ion-slides>

  </ion-content>
  <!-- Fab -->
  <button ng-if="activatedFab"  id="newReaction"
          ng-class="[changeFab ? 'fabChangeSlide' : '', addFab ? 'fabEnter' : '', removeFab ? 'exitFab' : '']"
          class="button icon ion-plus button-positive afas-fab"
          ng-click="goToNewReaction(doc.Id, doc.PageId)"></button>
  <multiple-views-support width="60%" />
</ion-view>
