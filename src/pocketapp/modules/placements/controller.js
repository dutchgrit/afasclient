angular.module("placement.controller",["AfasServices"]).factory("SharedPlacementService",["PlacementServiceFactory",function(e){var n=e.getInstance();return{getPlacementService:function(){return n}}}]).controller("PlacementsController",["$scope","$state","$timeout","$ionicScrollDelegate","$ionicTabsDelegate","$ionicSlideBoxDelegate","$ionicActionSheet","$ionicPopup","ListServiceFactory","ModalFilterService","SharedPlacementService","ConfigService","SearchService","FavoriteService","maxListTake","ConnectorService","MultipleViewsManager","EnvConfigService","ModalSearchService","ListServiceFactory",function(e,n,t,a,o,l,i,c,r,s,d,m,p,g,u,f,v,h,S,r){function $(n){var t=e.tabs[n];t.loading=!0,t.searched=!1,I.getPlacements(0,u,t.mode).then(function(n){t.loaded=n.length,t.showmore=t.loaded>=u,1==t.mode&&(n[0]&&n[0].organisation?b.handleHeaders(n,P):b.handleHeaders(n,y)),t.placements=n,t.searched=!0,e.$broadcast("scroll.refreshComplete")})["finally"](function(){t.loading=!1})}var I=d.getPlacementService(),b=r.getInstance();e.pageTitle=atrans("placements","Plaatsingen"),e.refreshText=atrans("refreshtext","Laat los om te verversen"),e.favorites=null,e.tabs=[{name_id:"tabActualPlacements",mode:0,title:atrans("actualplacements","Actueel")},{name_id:"tabAllPlacements",mode:1,title:atrans("allplacementsshort","Alle")}],e.tabs.map(function(e,n){return e.loading=!1,e.searched=!1,e.query=null,e}),e.scrollTop=function(){a.$getByHandle("placements").scrollTop(!0)},e.$on("$ionicView.beforeEnter",function(){e.landscape=e.isLandscape()}),$(0),e.$on("$ionicView.unloaded",function(){e.slider=void 0});var y={ctype:5,defname:"description",dtype:1,id:"description",name:"Klantovereenkomst"},P={ctype:5,defname:"organisation",dtype:1,id:"organisation",name:"Organisatie"};e.loadMorePlacements=function(){var n=e.tabs[e.slider.activeIndex];n.loading||(n.loading=!0,I.getPlacements(n.loaded,u,n.mode).then(function(t){n.showmore=t.length>n.loaded,n.loaded=t.length,1==n.mode&&b.handleHeaders(t,orderBy),n.placements=t,e.$broadcast("scroll.infiniteScrollComplete")})["finally"](function(){n.loading=!1,a.$getByHandle("placements").resize(),e.$broadcast("scroll.refreshComplete")}))},e.refresh=function(e){$(e)},e.goToPlacement=function(t){var a=e.tabs[e.slider.activeIndex];v.isActive()?(e.selectedPlacement=t,v.updateView("placements-detail",{placementId:t,mode:a.mode})):n.go("menu.placement",{placementId:t,mode:a.mode})},e.$on("$ionicSlides.sliderInitialized",function(n,t){e.slider=t.slider,o.$getByHandle("tabsplacements").select(0),e.slider.lockSwipes()}),e.$on("$ionicSlides.slideChangeStart",function(e,n){t(function(){o.$getByHandle("tabsplacements").select(n.slider.activeIndex)},1)}),e.selectPlacementTab=function(n){e.slider&&e.slider.activeIndex!=n&&(e.slider.unlockSwipes(),e.slider.slideTo(n),e.slider.lockSwipes(),e.tabs[n].searched||e.refresh(n))}}]).controller("PlacementController",["$scope","$state","$timeout","$ionicTabsDelegate","SharedPlacementService","ConfigService","MultipleViewsManager","$stateParams","FavoriteService",function(e,n,t,a,o,l,i,c,r){function s(){d(),m.getPlacement(e.placementId,e.mode).then(function(n){l.getConfig().then(function(t){e.placement=n,e.googleMapsLink="https://maps.google.com/?q="+encodeURIComponent(n.work_loc_street)+"%20"+encodeURIComponent(n.work_loc_house_number)+",%20"+encodeURIComponent(n.work_loc_city)+",%20"+encodeURIComponent(n.work_loc_country)+"&key="+encodeURIComponent(t.googlemapikey),e.googleMapsLink=e.googleMapsLink.replace("'","%27").replace('"',"%22"),e.googleMapsImage="https://maps.googleapis.com/maps/api/staticmap?markers="+encodeURIComponent(n.work_loc_street)+"%20"+encodeURIComponent(n.work_loc_house_number)+",%20"+encodeURIComponent(n.work_loc_city)+",%20"+encodeURIComponent(n.work_loc_country)+"&size=400x200&key="+encodeURIComponent(t.googlemapikey),e.googleMapsImage=e.googleMapsImage.replace("'","%27").replace('"',"%22")})["finally"](function(){e.loaded=!0})})}function d(){e.tabs=[{title:"Overzicht",name_id:"tabGeneral"},{title:"Team",name_id:"tabTeam"}],e.useTabs=!0}var m=o.getPlacementService();e.placementId=null,e.mode=null,e.loaded=!1,e.showplaceholder=i.isActive(),e.tabs=[{title:"Overzicht",name_id:"tabGeneral"}],e.pageTitle=i.isActive()?atrans("placements","Plaatsingen"):atrans("placementdetails","Details plaatsing"),c&&null!=c.placementId&&(e.placementId=c.placementId,e.mode=c.mode,s()),i.updated("placements-detail",function(n){n&&null!=n.placementId&&(e.loaded=!1,e.placementId=n.placementId,e.mode=n.mode,e.showplaceholder=!1,s(),e.selectPlacementTab(0))}),e.$on("$ionicSlides.sliderInitialized",function(n,t){e.slider=t.slider,a.$getByHandle("tabsplacement").select(0)}),e.$on("$ionicSlides.slideChangeStart",function(e,n){t(function(){a.$getByHandle("tabsplacement").select(n.slider.activeIndex)},1)}),e.selectPlacementTab=function(n){e.slider&&e.slider.activeIndex!=n&&e.slider.slideTo(n)}}]);